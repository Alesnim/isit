---
description: 'Цель работы: ознакомится с типами задач для алгоритмов машинного обучения'
---

# Практическая 10. Введение в машинное обучение

## Теоретические сведения

### Знакомство с линейной алгеброй

В машинном обучении широко используется понятие признака.&#x20;

{% hint style="info" %}
**Признаком **называется отображение из множества объектов в множество допустимых значений этого признака.&#x20;
{% endhint %}

Если задано множество объектов и некоторый набор признаков, для каждого объекта можно построить его признаковое описание — вектор, составленный из значений этого набора признаков на данном объекте.&#x20;

Пусть, например, для каждого магазина торговой сети требуется предсказать прибыль в следующем месяце. Эта задача анализа данных имеет огромную практическую ценность. Действительно, если будет выяснено, что прибыль некоторого магазина упадет, можно будет заблаговременно принять меры по предотвращению этого. В этой задаче множеством объектов является множество магазинов. В качестве признаков разумно выбрать следующие:

* Прибыль магазина в каждом из 4-ех последних месяцев (4 признака)
* Планируемое число акций для каждой из трех основных категорий (3 признака)
* Географические координаты магазина: широта и долгота (2 признака)
* Число дней, когда магазин будет открыт в ближайшем месяце. (1 признак)

Признаковым описанием магазина будет вектор, в котором находятся значения данных 10 признаков для данного конкретного магазина.&#x20;

Если необходимо работать с признаковыми описаниями сразу нескольких объектов, удобно ввести двумерную структуру данных — матрицу, в которой каждая строка соответствует одному объекту, а каждый столбец — признаку. Работать с векторами и матрицами позволяет аппарат линейной алгебры.

**Векторное пространство** $$V$$ представляет собой набор элементов, называемых векторами, для которых определены операции сложения друг с другом и умножения на скаляр, причем эти операции замкнуты и подчинены восьми аксиомам:

* Коммутативность сложения&#x20;
* Ассоциативность сложения&#x20;
* Существование нейтрального элемента относительно сложения&#x20;
* Существование для каждого вектора x противоположенного вектора $$-x$$&#x20;
* Ассоциативность умножения на скаляр
* Унитарность: умножение на единичный скаляр не меняет вектор
* Дистрибутивность умножения на вектор относительно сложения скаляров
* Дистрибутивность умножения на скаляр относительно сложения векторов

#### Линейная независимость

Линейная зависимость является одним из основополагающих понятий линейной алгебры. Конечный набор элементов векторного пространства называется линейно зависимым, если существует нетривиальная линейная комбинация элементов из этого набора, равная нулевому элементу. Линейная комбинация называется тривиальной, если все коэффициенты в ней равны нулю.

Оказывается, что конечный набор элементов векторного пространства линейно зависим тогда и только тогда, когда один из элементов этого набора может быть выражен через оставшиеся.&#x20;

С помощью понятия линейной независимости вводится понятие размерности векторного пространства. А именно: **размерностью **$$dimV$$ векторного пространства $$V$$ называется максимальное число линейно независимых векторов в нем.

Пусть дан некоторый набор объектов $$X$$ и набор $$f_j : X \to \mathbb{R}$$ вещественнозначных признаков. В этом случае набор векторов признаков может быть линейно зависим. Например, признаки вес товара на первом складе, вес товара на втором складе и вес товара на обоих складах линейно зависимы. Другой случай — два вещественнозначных признака отличаются множителем, например являются одной и той же величиной в разных единицах измерения. В обоих случаях наблюдается избыточность информации.

Такая избыточность приводит к дополнительным затратам ресурсов. Более того, линейная зависимость векторов признаков приводит к возникновению проблем при обучении линейной регрессионной модели — об этом пойдет речь в следующем курсе.

Чтобы проверить, являются ли система векторов линейно зависимой, можно составить из них матрицу и вычислить ее ранг. Об этом будет рассказано далее.

#### Нормирование пространства

Для обобщения понятия длины вектора используется понятие нормы. Функция $$\| \cdot \| : V \to \mathbb{R}$$ называется нормой в векторном пространстве $$V$$, если для нее выполняются аксиомы нормы:

1. $$\| x \| = 0 \Leftrightarrow x = 0$$ kxk = 0 ⇐⇒ x = 0 (Нулевую норму имеет только нулевой вектор)
2. &#x20;$$\forall x, y \in L : \| x + y \| \le \| x \| + \| y \|$$ ∀x, y ∈ L : kx + yk ≤ kxk + kyk (Неравенство треугольника)
3. $$\forall \alpha \in  \mathbb{R}, \forall x \in V : \|\alpha x \| = |\alpha| \|x \|$$ (Условие однородности)

Пространство с введенной на нем нормой называют нормированным пространством. Обычно используется Евклидова норма $$\| x \| _2$$, другой пример нормы — Манхэттенская норма $$\| x \| _1$$:

$$
\| x \|_2 = \sqrt{\sum_{i = 1}^n x_i^2} \qquad 
\|x\|_1 =  \sum_{i = 1}^n \| x_i \|
$$

#### Метрические пространства

Понятие **расстояние **обобщается с помощью понятия метрики. Пусть $$X$$ — некоторое множество, а числовая функция $$d : X × X \to  \mathbb{R}$$ , которая называется метрикой, удовлетворяет следующим условиям:

1. $$d(x, y) = 0 \Leftrightarrow x =y$$ (аксиома тождества).
2. $$d(x, y) = d(x,y)$$(аксиома симметрии).
3. $$d(x,y) \le d(x,y) + d(y,z)$$ (неравенство треугольника).

Любое нормированное пространство можно превратить в метрическое, определив функцию расстояния $$d(x,y) = \| y - x \|$$. Например, Евклидова и Манхэттенская метрики имеют вид:

$$
p_2(x, y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}
\qquad
p_1(x,y) = \sum_{i=1}^n | x_i - y_i |
$$

Название "манхэттенская метрика" связано с уличной планировкой Манхэттена.

#### Скалярное произведение

Скалярным произведением называется функция $$\langle x, y \rangle : V × V \to \mathbb{R}$$ , удовлетворяющая следующим условиям:

1. $$\langle \alpha x_1 + \beta x_2, y \rangle = \alpha \langle x_1, y \rangle + \langle \beta x_2, y \rangle ;   \quad \forall \alpha, \beta \in  \mathbb{R},  \forall x_1, x_2, y \in V$$
2. &#x20;$$\langle y , x \rangle = \langle x, y \rangle ; \quad \forall x,y \in V$$
3. &#x20;$$\langle x , x \rangle > 0; \quad \forall x \in V ; \quad \langle 0,0 \rangle = 0$$&#x20;

В современном аксиоматическом подходе уже на основе понятия скалярного произведения векторов вводятся следующие производные понятия:

1. Длина вектора  $$| x|  = \sqrt{\langle x,x \rangle}$$
2. Угол между векторами $$\alpha = arccos \frac{\langle a, b \rangle}{\sqrt{\langle a, a \rangle \langle b,b \rangle}}$$&#x20;

В случае Евклидового пространства скалярное произведение задается формулой $$\langle a, b \rangle  = \sum_{i=1}^n a_i b_i$$ и можно убедиться, что такое определение согласуется с введенной ранее Евклидовой нормой:

$$
\| x \| = \sqrt{\langle x , x \rangle} = \sqrt{\sum_{i= 1}^n x_i^2} = \| x_2 \|
$$

#### Матрицы

{% hint style="info" %}
**Матрицей **размера $$n \times m$$ называется прямоугольная таблица специального вида, состоящая из $$n$$ строк и $$m$$столбцов, заполненная числами.
{% endhint %}

Матрица обычно обозначаются заглавными буквами латинского алфавита, например $$A$$. Элементы матрицы A обозначаются $$a_{ij}$$ , где $$i$$ и $$j$$ — номер строки и столбца, где расположен этот элемент, соответственно. Пространство матриц $$n \times m$$ обозначается $$\mathbb{R}^{n \times m}$$.

Матрицы можно использовать для работы с системами линейных алгебраических уравнений. Например, в задачах линейной классификации решается система линейных алгебраических уравнений с матрицей объектпризнак относительно вектора неизвестных параметров. При этом получившаяся система уравнений может как иметь бесконечное число решении, так и не иметь решений вовсе. Подробнее эти вопросы будут обсуждаться в курсе по машинному обучению.

Для матриц размера $$m \times n$$ результат операции умножения на вектор-столбец размера $$n$$ (т.е. на матрицу размера $$n \times 1$$ ) есть новый вектор-столбец размера $$m$$:

$$
A_w = 
\begin{pmatrix}
   \sum_{i=1}^n a_{1i}w_i\\
    \sum_{i=1}^n a_{2i}w_i\\
    ... \\
   \sum_{i=1}^n a_{mi}w_i
  \end{pmatrix}
$$

Другими словами, можно сказать, что матрица задает линейное отображение. Системы линейных уравнений лаконично записываются с помощью матриц, например:

$$
\begin{cases} 
12w_1 + 7w_2 + 21w_3 + 31w_4 + 11w_5 = 1 \\
45w_1 − 2w_2 + 14w_3 + 27w_4 + 19w_5 = 0 \\
−3w_1 + 15w_2 + 36w_3 + 71w_4 + 21w_5 = 0 \\
4w_1 − 13w_2 + 55w_3 + 34w_4 + 15w_5 = 1
\end{cases}
$$

в матричной записи имеет вид:

$$
\begin{pmatrix}
12 \; 7\; 21 \; 31\; 11 \\
45 \; −2 \;14 \;27\; 19 \\
−3 \; 15\; 36\; 71\; 21 \\
4 \; −13\; 55\; 34\; 15  
\end{pmatrix}
\cdot 
\begin{pmatrix}
w_1 \\
w_2 \\
w_3 \\ 
w_4 \\
w_5 
\end{pmatrix}
= 
\begin{pmatrix}
1 \\ 0 \\ 0 \\ 1
\end{pmatrix}
$$

#### Понятие собственного вектора

Важной характеристикой матрицы, а также линейного преобразования, заданного этой матрицей, является спектр — набор собственных векторов и соответствующих собственных значений.&#x20;

Собственным вектором линейного преобразования $$A$$ называется такой ненулевой вектор $$x \in V$$ , что для некоторого $$\lambda \in  \mathbb{R}$$ выполняется $$Ax = \lambda x$$. Линейное преобразование может как не иметь собственных векторов вообще, например поворот в двумерном пространстве (кроме нескольких исключительных случаев), или иметь n собственных векторов с различными собственными значениями. Вопросы существования собственных векторов преобразования разбираются в курсе линейной алгебры.&#x20;

Понятие собственного вектора используется в Методе Главных Компонент, который предназначен для уменьшения размерности данных с потерей наименьшего количества информации.

### Задачи оптимизации c помощью scipy

В качестве простейшей оптимизационной задачи рассмотрим поиск локального минимума функции одной переменной.

$$
f(x) = x^4 + 3x^3 -13x^2 -6x + 26
$$

Решение задачи начнем с построения графика функции (рис. 1):

```python
import matplotlib.pyplot as plt
import numpy as np

x = np.linspace(-5, 0.1, num=50)
y = [func(xx) for xx in x]
plt.plot(x, y)
```

![График функции](<../.gitbook/assets/image (73).png>)

Из графика видно, что функция имеет минимум в районе точки -4. Для нахождения более точного значения минимума функции в Scipy служит функция `minimize(func, x0, args)`, которая предназначена для поиска минимума любой функции, `x0` — вектор-столбец начальных приближений длиной $$n$$ , функция `func` определяет функцию, минимум которой ищется. Функция возвращает объект содержащий минимум функции `x` и точку, в которой функция достигает этого значения `fun`.

На листинге представлено использование optim для поиска минимума функции:

```python
import scipy.optimize as opt
res = opt.minimize(func, -5)
print(res.x)
print(res.fun)
```

![](<../.gitbook/assets/image (72).png>)

### Работа с матрицами в Numpy

В NumPy реализовано много операций для работы с массивами:

* создание, модификация массива (изменение формы, транспонирование, поэлементные операции),
* выбор элементов,
* операции с массивами (различные типы умножения), сравнение массивов
* решение задач линейной алгебры (системы линейных уравнений, собственые вектора. собственные значения)
* создание наборов случайных данных
* быстрое преобразование Фурье

В NumPy можно выделить три вида массивов:

* произвольные многомерные массивы (array)
* матрицы (matrix) – двухмерные квадратные массивы, для которых дополнительно определены операции возведения в степень и перемножения. Для работы с матрицами можно вместо “numpy” подключать “numpy.matrix”, в котором реализованы те же самые операции, только массивы – результаты операций будут приводится к типу “matrix”.
* сетки (grid) – массивы, в которых записаны значения координат точек сети (обычно ортогональной). Сетки позволяют удобно вычислять значение функций многих переменных.

&#x20;Для создания массивов существует множество функций. Самая распространенная из них `array()`.

```
np.array([[1, 2], [3, 4]])
```

| Метод                                              | Что делает                     |
| -------------------------------------------------- | ------------------------------ |
| array(object\[, dtype, copy, order, subok, ndmin]) | Создать массив                 |
| asarray(a\[, dtype, order])                        | Преобразовать в массив         |
| asmatrix(data\[, dtype])                           | Представить данные как матрицу |
| copy(a)                                            | Возвращает копию объекта       |

#### Индексация массива

Доступ к элементам массива получают по индексу (разумеется, индекс первого элемента 0):

```python
a = np.array([[1,2,3, 4.2], [2, 3, 4, 5]], dtype="float")
print(a[0])
```

Для индексации многомерных массивов используют кортежи (индексы перечисляют через запятую):

```
print(a[1, 1]) # вернет второй элемент второй строки
```

#### Создние массивов определенного вида

| Метод                                                                  | Что делает                                                    |
| ---------------------------------------------------------------------- | ------------------------------------------------------------- |
| empty(shape\[, dtype, order]), empty\_like(a \[, dtype, order, subok]) | выделяет место без инициализации (случайные числа)            |
| eye(N\[, M, k, dtype])                                                 | двухмерный диагональный со сдвигом                            |
| identity(N\[, dtype])                                                  | единичная матрица (квадратная)                                |
| ones(shape\[, dtype, order]) ones\_like(a\[, out])                     | все единицы                                                   |
| zeros(shape\[, dtype, order]) zeros\_like(a\[, dtype, order, subok])   | все нули                                                      |
| tri(N\[, M, k, dtype])                                                 | нижняя треугольная (из единиц)                                |
| diag(a\[, k])                                                          | вырезает диагональ или создает двумерную диагональную матрицу |
| mat(data\[, dtype])                                                    | преобразует данные в матрицу                                  |

#### Трансформация массива

| Функция                        | Что делает                                                                                    |
| ------------------------------ | --------------------------------------------------------------------------------------------- |
| resize(a, new\_shape)          | возвращает новый массив заданной формы (если элементов не хватает, то заполняется циклически) |
| reshape(a, newshape\[, order]) | новая форма для данных (полный размер обязан совпадать)                                       |
| ravel(a\[, order])             | возвращает новый одномерный массив                                                            |
| swapaxes(a, axis1, axis2)      | меняет две оси в массиве                                                                      |
| rot90(a\[, k])                 | поворот массива против часовой стрелке на 90 градусов                                         |
| column\_stack(tup)             | собирает одномерные массивы -столбцы в двухмерный                                             |
| concatenate(tup\[, axis])      | соединяет последовательность массивов вместе                                                  |

#### Действия над матрицами/массивами

&#x20;Объекты класса numpy.ndarray можно использовать как операнды в выражениях, при этом все операции с массивами будут выполняться **поэлементно**, то есть итогом операции будет новый массив, содержащий результаты применения операции к каждому элементу исходного массива:

```python
a = np.arange(6)
print(a + 1)
print(a * 3)
print(a ** 3)
print(a < 3)
```

## Ход работы

### Задание 1. Оптимизация функций в Scilab

{% hint style="info" %}
Функция `minimize `ожидает на вход функцию возвращающую несколько значений: объект функции `fun`, точку `x0`&#x20;
{% endhint %}

1. Прочесть справку про функциям `minimize `,  `basinhopping`
2. Найти оптимум функции: $$f(x) = a + bx + cx^2 + dx^3$$ при  $$x \in [-10, 53]$$

| №  | a   | b   | c    | d  |
| -- | --- | --- | ---- | -- |
| 1  | 20  | 3   | -40  | 1  |
| 2  | 30  | -50 | -55  | 3  |
| 3  |  10 | -20 | -40  | 1  |
| 4  |  2  | -5  | 47   | -3 |
| 5  |  4  | -5  | -26  | 2  |
| 6  | 50  | -63 | -25  | 1  |
| 7  | 23  | -80 | -64  | 5  |
| 8  | 12  | -8  | -40  | 3  |
| 9  | 14  | 2   | -26  | 1  |
| 10 | 26  | -86 | -59  | 3  |
| 11 | 44  | 3   | -63  | 1  |
| 12 | 71  | 3   | -120 | 2  |
| 13 | 62  | -1  | -86  | 2  |
| 14 | 48  | -38 | -71  | 5  |
| 15 | 39  | -96 | -67  | 4  |

### Задача 2. Работа с матрицами

1. Решить СЛАУ при помощи [метода Крамера](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4\_%D0%9A%D1%80%D0%B0%D0%BC%D0%B5%D1%80%D0%B0):

| № | $$x_1$$  | $$x_2$$  | $$x_3$$  | $$x_4$$  | $$x_5$$  | b  |
| - | -------- | -------- | -------- | -------- | -------- | -- |
| 1 | 2        | 1        | -5       | 4        | -8       | 32 |
| 2 | 5        | -12      | 8        | 4        | 0        | 0  |
| 3 | 3        | 2        | 5        | -2       | 17       | 9  |
| 4 | 0        | 2        | -1       | 2        | 2        | 14 |

2\. Решить СЛАУ при помощи [метода обратной матрицы](http://cyclowiki.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4\_%D0%BE%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B9\_%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D1%8B#:\~:text=%D0%9C%D0%B5%D1%82%D0%BE%D0%B4%20%D0%BE%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B9%20%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D1%8B%20%E2%80%94%20%D1%8D%D1%82%D0%BE%20%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1,%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D0%B0%20\(%D0%BA%20%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D0%B5%20A\).):

| № | $$x_1$$  | $$x_2$$  | $$x_3$$  | $$x_4$$  | b  |
| - | -------- | -------- | -------- | -------- | -- |
| 1 | 5        | 8        | -18      | 4        | 8  |
| 2 | 4        | 7        | 12       | 9        | 0  |
| 3 | 1        | 1        | 1        | 1        | 1  |
| 4 | 2        | 7        | 2        | 3        | 10 |

## Контрольные вопросы

1. Дайте определение понятию собственный вектор
2. Что такое признак
3. Дайте определение понятию нормирование
4. Что такое векторное пространство
5. Что такое пространство признаков

### Критерии оценки практического занятия

Оценивается знание материала, способность к его обобщению, критическому осмыслению, систематизации.&#x20;

* 3 балла: студент полностью выполнил задания.
* 2 балла: в усвоении учебного материала допущены небольшие пробелы.
* 1 балл: неполно или непоследовательно реализовано задание.
* 0 баллов: не раскрыто основное содержание учебного материала.

**Максимальный балл: 3 балла**
