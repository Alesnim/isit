---
description: 'Цель работы: ознакомится с применением и устройством генетических алгоритмов'
---

# Практическая 8. Введение в генетические алгоритмы

## Теоретические сведения

Генетические алгоритмы относят к области мягких вычислений. Термин «мягкие вычисления» введен Лофти Заде в 1994 году. Это понятие объединяет такие области, как нечеткая логика, нейронные сети, вероятностные рассуждения, сети доверия1 и эволюционные алгоритмы, которые дополняют друг друга и используются в различных комбинациях или самостоятельно для создания гибридных интеллектуальных систем. Первая схема генетического алгоритма была предложена в 1975 году в Мичиганском университете Джоном Холландом (John Holland), а предпосылками этому послужили работы Ч. Дарвина (теория эволюции) и исследования Л.Дж.Фогеля, А.Дж. Оуэнса, М.Дж.Волша по эволюции простых автоматов, предсказывающих символы в цифровых последовательностях (1966).

Новый алгоритм получил название «репродуктивный план Холланда» и в дальнейшем активно использовался в качестве базового алгоритма в эволюционных вычислениях. Идеи Холланда развили его ученики Кеннет Де Йонг (Kenneth De Jong) из университета Джорджа Мейсона (Вирджиния) и Дэвид Голдберг (David E. Goldberg) из лаборатории ГА Иллинойса. Благодаря им, был создан классический ГА, описаны все операторы и исследовано поведение группы тестовых функций (именно алгоритм Голдберга и получил название «генетический алгоритм»).&#x20;

{% hint style="info" %}
&#x20;**Генетический алгоритм** (англ. genetic algorithm) — это эвристический алгоритм поиска, используемый для решения задач оптимизации и моделирования путём последовательного подбора, комбинирования и вариации искомых параметров с использованием механизмов, напоминающих биологическую эволюцию.
{% endhint %}

### Простой пример генетического алгоритма

Рассмотрим принципы работы генетических алгоритмов на максимально простом примере. Пусть требуется найти глобальный минимум функции:

$$
y(x) = 5 -24x + 17x^2 - \frac{11}{3}x^3 + \frac{1}{4}x^4
$$

на отрезке \[0; 7] (рис. 1). На этом отрезке функция принимает минимальное значение в точке $$x = 1$$ . Очевидно, что в точке  функция попадает в локальный минимум. Если для нахождения глобального минимума использовать градиентные методы, то в зависимости от начального приближения можно попасть в данный локальный минимум.

![Рисунок 1 - График функции](<../.gitbook/assets/image (45).png>)

Рассмотрим на примере данной задачи принцип работы генетических алгоритмов. Для простоты положим, что x принимает лишь целые значения, т.е. $$x \in \{0, 1, 2, 3, 4, 5, 6, 7 \}$$. Это предположение существенно упростит изложение, сохранив все основные особенности работы генетического алгоритма.&#x20;

Выберем случайным образом несколько чисел на отрезке $$[0; 7]: \{2, 3, 5, 4 \}$$. Будем рассматривать эти числа в качестве пробных решений нашей задачи.

Основной идеей генетических алгоритмов является организация «борьбы за существование» и «естественного отбора» среди этих пробных решений. Запишем пробные решения в двоичной форме:** {010, 011, 101, 100}**. Поскольку генетические алгоритмы используют биологические аналогии, то и применяющаяся терминология напоминает биологическую.&#x20;

Так, одно пробное решение, записанное в двоичной форме, мы будем называть особью или _**хромосомой**_, а набор всех пробных решений – _**популяцией**_. Как известно, принцип естественного отбора заключается в том, что в конкурентной борьбе выживает наиболее приспособленный. В нашем случае приспособленность особи определяется целевой функцией: чем меньше значение целевой функции, тем более приспособленной является особь, т.е. пробное решение, использовавшееся в качестве аргумента целевой функции (см. табл. 1).

Теперь приступим к процессу _**размножения**_: попробуем на основе исходной популяции создать новую, так чтобы пробные решения в новой популяции были бы ближе к искомому глобальному минимуму целевой функции. Для этого сформируем из исходной популяции брачные пары для скрещивания. Поставим в соответствие каждой особи исходной популяции случайное целое число из диапазона от 1 до 4. Будем рассматривать эти числа как номера членов популяции. При таком выборе какие-то из членов популяции не будут участвовать в процессе размножения, так как образуют пару сами с собой. Какие-то члены популяции примут участие в процессе размножения неоднократно с различными особями популяции. Процесс размножения (_рекомбинация_) заключается в обмене участками хромосом между родителями. Например, пусть скрещиваются две хромосомы **111111** и **000000**. Определяем случайным образом точку разрыва хромосомы, пусть, это будет 3: **111|111 **и** 000|000**. Теперь хромосомы обмениваются частями, стоящими после точки разрыва, и образуют двух новых потомков: **111000** и **000111**.

#### Таблица 1

| № | Целое число | Двоичное число | Приспособленость |
| - | ----------- | :------------: | :--------------: |
| 1 | 2           |       010      |       -0,33      |
| 2 | 3           |       011      |       7,25       |
| 3 | 5           |       101      |       7,92       |
| 4 | 4           |       100      |       10,33      |

Для нашей популяции процесс создания первого поколения потомков показан в таблице 2.

{% hint style="info" %}
**Точка кроссинговера** - точка внутри хромосомы, в которой обе хромосомы делятся на две части и обмениваются ими
{% endhint %}

#### Таблица 2

| № | Особь популяции | Выбранный номер | Вторая выбранная особь | Точка кроссинговера | Особи-потомки |
| - | --------------- | --------------- | ---------------------- | ------------------- | ------------- |
| 1 | 010             | 1               | 010                    | 1                   | 000           |
| 2 | 011             | 4               | 100                    | 1                   | 110           |
| 3 | 101             | 3               | 101                    | 2                   | 100           |
| 4 | 100             | 1               | 010                    | 2                   | 011           |

Следующим шагом в работе генетического алгоритма являются мутации, т.е. случайные изменения полученных в результате скрещивания хромосом. Пусть вероятность мутации равна 0,3. Для каждого потомка возьмем случайное число на отрезке $$[0; 1]$$, и если это число меньше 0,3, то инвертируем случайно выбранный ген (заменим 0 на 1 или наоборот) (см. табл. 3).

#### Таблица 3

ОП - особи-потомки;

СЧ - случайное число;

ВГ - выбранный ген;

ППМ - потомок после мутации;

ПДМ - потомок до мутации;

ППоМ - приспособленность после мутации.

| № | ОП  | СЧ  | ВГ | ППМ | ПДМ   | ППоМ  |
| - | --- | --- | -- | --- | ----- | ----- |
| 1 | 000 | 0,1 | 3  | 001 | 5     | -5,42 |
| 2 | 110 | 0,6 | -  | 110 | 5     | 5     |
| 3 | 100 | 0,5 | -  | 100 | 10,33 | 10,33 |
| 4 | 011 | 0,2 | 1  | 111 | 7,25  | 12,58 |

Как видно на примере, мутации способны улучшить (первый потомок) или ухудшить (четвертый потомок) приспособленность особи-потомка. В результате скрещивания хромосомы обмениваются «хвостами», т.е. младшими разрядами в двоичном представлении числа. В результате мутаций изменению может подвергнуться любой разряд, в том числе, старший. Таким образом, если скрещивание приводит к относительно небольшим изменениям пробных решений, то мутации могут привести к существенным изменениям значений пробных решений (см. рис. 2). Теперь из четырех особей-родителей и четырех полученных особей потомков необходимо сформировать новую популяцию. В новую популяцию отберем четыре наиболее приспособленных особей из числа «старых» особей и особей-потомков (см. табл. 4). В результате получим новое поколение, которое представлено на рис. 3.&#x20;

Получившуюся популяцию можно будет вновь подвергнуть кроссинговеру, мутации и отбору особей в новое поколение. Таким образом, через несколько поколений мы получим популяцию из похожих и наиболее приспособленных особей. Значение приспособленности наиболее «хорошей» особи (или средняя приспособленность по популяции) и будет являться решением нашей задачи. Следуя этому, в данном случае, взяв наиболее приспособленную особь **001** во втором поколении, можно сказать, что минимумом целевой функции является значение −5,42, соответствующее аргументу $$x = 1$$.&#x20;

Тем самым попадания в локальный минимум удалось избежать! На данном примере разобран вариант простого генетического алгоритма. При дальнейшем использования ГА к разным задачам возможно моделирование основных операторов алгоритма.

![Рисунок 2 - Изменение популяции во время естественного отбора](<../.gitbook/assets/image (46).png>)

![Рисунок 3 -  Минимизируемая функция и особи новой популяции](<../.gitbook/assets/image (49).png>)

#### Таблица 4

| № | Особи | Приспособляемость | Новая популяция | Приспособленность в новой популяции  |
| - | ----- | ----------------- | --------------- | ------------------------------------ |
| 1 | 010   | -0,33             | 001             | -5,42                                |
| 2 | 011   | 7,25              | 010             | -0,33                                |
| 3 | 101   | 7,92              | 110             | 5                                    |
| 4 | 100   | 10,33             | 011             | 7,25                                 |
| 5 | 001   | -5.42             | -               | -                                    |
| 6 | 110   | 5                 | -               | -                                    |
| 7 | 100   | 10,33             | -               | -                                    |
| 8 | 111   | 12,58             | -               | -                                    |

### Пример работы с генетическим алгоритмом на Python

Для работы с генетическими алгоритмами необходимо установить библиотеку [geneticalgorithm](https://github.com/rmsolgi/geneticalgorithm). Для этого в окне юпитер-ноутбука необходимо написать следующую команду:

```
!pip install geneticalgorithm 
```

После успешной установки можно воспользоваться библиотекой для нахождения минимума функции:

```python
import numpy as np
from geneticalgorithm import geneticalgorithm as ga
# импортируем библиотеки


# определяем функцию, которую будем оптимизировать
def f(x):
    result = 5 - 24*x + 17*x**2 - (11/3)*x**3 + (1/4)*x**4
    return np.array(result)

# определяем ограничения в которых будем искать оптимум
varbound=np.array([[0,7]])

# создаем объект модели генетического алгоритма
model=ga(function=f,dimension=1,variable_type='real',variable_boundaries=varbound)
# запускаем модель для поиска оптимума
model.run()
```

После выполнения ячейки вывод выглядит следующим образом:&#x20;

![Рисунок 4 - Вывод модели генетического алгоритма](<../.gitbook/assets/image (66).png>)

Выведем график функции и отметим на нем точку оптимума найденную генетическим алгоритмом.&#x20;

```python
import matplotlib as plt
plt.pyplot.plot(np.linspace(-1, 8, 40), \\
    [f(x) for x in np.linspace(-1, 8, 40)])
plt.pyplot.scatter(model.best_variable, \\
    model.best_function, marker='x', c='r')
```

График представлен на рисунке 5.&#x20;

![Рисунок 5 - График функции с отмеченной точкой минимума](<../.gitbook/assets/image (71).png>)

## Ход работы

### Задание 1

Ознакомится с документацией к библиотеке [geneticalgorithm](https://github.com/rmsolgi/geneticalgorithm)

### Задание 2. Оптимизация функции генетическим алгоритмом

Выполнить поиск минимума для функции упрощенным генетическим алгоритмом по вариантам:&#x20;

1. $$y(x) = x^4 - 24 + 42, x = [-10; 7]$$&#x20;
2. $$y(x) = 2 - \sqrt{x ^3} + x^2, x = [-2; 4]$$&#x20;
3. $$y(x) = 42 + x^3 * 3, x= [-4; 4]$$&#x20;
4. $$y(x) = x^3 - 3x + 2, x = [-2;4]$$&#x20;
5. $$y(x) = 42x - 4x^2 - \frac{12}{6}x^3 + \frac{3}{42}x^4, x = [-4; 8]$$&#x20;
6. $$y(x) = \frac{(2x+1)}{(x + 2)} +x^2 + 0.4x^3, x = [-4; 6]$$&#x20;
7. $$y(x) = x^3 - 3x + 3, x = [-1; 8]$$&#x20;
8. $$y(x) = (x-1)^2 + 4 , x = [-4; 4]$$&#x20;
9. $$y(x) = cos(x^2) + \sqrt{x}, x = [0;6]$$&#x20;
10. $$y(x) = sin(x + 42) + \frac{(x^2)}{4} - x, x=[0;7]$$&#x20;

### Задание 3. Оптимизация функции при помощи дифференциальной эволюции.

Прочтите справку про функцию оптимизации [differential\_evolution](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.differential\_evolution.html).&#x20;

Выполнить поиск минимума функции при помощи дифференциальной эволюции из пакета модуля Scipy:

1. $$y(x) = \sum_{i=1}^{n} x_i^2, x \in (-5.12, 5.12)$$&#x20;
2. $$z(x,y) =  x^2+y^2-cos(12x)-cos(18y), x \in (-2, 2)$$

## Контрольные вопросы

1. Что такое хромосома в генетическом алгоритме?
2. Дайте характеристику понятию рекомбинация
3. Что такое точка кроссинговера?

### Критерии оценки практического занятия

Оценивается знание материала, способность к его обобщению, критическому осмыслению, систематизации.&#x20;

* 3 балла: студент полностью выполнил задания.
* 2 балла: в усвоении учебного материала допущены небольшие пробелы.
* 1 балл: неполно или непоследовательно реализовано задание.
* 0 баллов: не раскрыто основное содержание учебного материала.

**Максимальный балл: 3 балла**
